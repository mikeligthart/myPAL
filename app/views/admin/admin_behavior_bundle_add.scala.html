@(error: String = "")

@admin(title = Messages("page.admin.behavior.title"), page = "behavior", table = "javascripts/tables/admin_behavior_bundle_add.js") {

    <link rel="stylesheet" media="screen" href='@routes.Assets.at("stylesheets/avatarBehaviorBundle.css")'>

    <div class="row">
        <h3>@Messages("page.admin.behavior.bundle.add")</h3>
        @if(error != "") {
        <div class="alert alert-danger" role="alert">
            <span class="glyphicon glyphicon-exclamation-sign" aria-hidden="true"></span>
            <span class="sr-only">@Messages("page.general.error")</span>
            @error
        </div>
        }
    </div>
    <div class="row">
        <h4>@Messages("page.admin.behavior.bundle.add.timeline")</h4>
    </div>
    <div class="row bundleTimeline">
        <div class="col-md-2 timeLineElement">Start</div>
    </div>
    <hr>

    <div class="row">
        <form action="@routes.Admin.addBehaviorBundle()" method="post">
            <div class="text-left">
                    <label class="col-sm-2 control-label" for="bundleDescription">@Messages("page.admin.behavior.bundle.add.description.label")</label>
                    <div class="col-sm-3">
                        <textarea rows="2"
                                  class="form-control"
                                  id="bundleDescription"
                                  name="bundleDescription"
                                  placeholder='@Messages("page.admin.behavior.bundle.add.description.placeholder")'></textarea>
                    </div>
            </div>
            <div class="text-right">
                <input id="behaviorBundle" name="behaviorBundle" type="hidden" value="" />
                <button class="col-sm-2 btn btn-default removeLastBehavior bitOfPadding">@Messages("page.admin.behavior.bundle.removebehavior")</button>
                <button class="col-sm-2 btn btn-default resetBundle bitOfPadding">@Messages("page.admin.behavior.bundle.reset")</button>
                <input type="submit" value='@Messages("page.admin.behavior.bundle.add.submit")' class="col-sm-2 btn btn-primary"/>
            </div>
        </form>
    </div>

    <div class="row bitOfMargin">
        <h4>@Messages("page.admin.behavior.bundle.add.select")</h4>
        <table id="admin_behavior" class="table table-striped table-bordered" cellspacing="0" width="100%">
            <thead>
            <tr>
                <th>@Messages("page.admin.users.options")</th>
                <th>@Messages("page.admin.behavior.id")</th>
                <th>@Messages("page.admin.behavior.gesture")</th>
                <th>@Messages("page.admin.behavior.lines")</th>
                <th>@Messages("page.admin.behavior.avatarhtmltype")</th>
                <th>@Messages("page.admin.behavior.bundleID")</th>
            </tr>
            </thead>
            <tbody>
            <tr>
                <td>@Messages("page.admin.users.options")</td>
                <td>@Messages("page.admin.behavior.id")</td>
                <td>@Messages("page.admin.behavior.gesture")</td>
                <td>@Messages("page.admin.behavior.lines")</td>
                <td>@Messages("page.admin.behavior.avatarhtmltype")</td>
                <td>@Messages("page.admin.behavior.bundleID")</td>

            </tr>
            </tbody>
        </table>
    </div>

    <div class="row buttonWithNavBar">
        <div class="col-md-6 text-left">
            <small>
                <b>@Messages("page.admin.behavior.legendHeader")</b>
                <br>
                <span class="noaudiofile">@Messages("page.admin.behavior.noaudiofile")</span>
                <br>
                <span class="validatedLineVariable">@Messages("page.admin.behavior.validatedvariable")</span>
                <br>
                <span class="unvalidatedLineVariable">@Messages("page.admin.behavior.unvalidatedvariable")</span>
            </small>
        </div>
        <div class="col-md-6 text-right">
            <a href="@routes.Admin.addBehaviorPage()" class="btn btn-default"><span class="glyphicon glyphicon-plus-sign" aria-hidden="true"></span> @Messages("page.admin.behavior.add")</a>
        </div>
    </div>




    <script src='@routes.Assets.at("javascripts/ekko-lightbox.min.js")' type="text/javascript"></script>
    <script>
        $(document).delegate('*[data-toggle="lightbox"]', 'click', function(event) {
            event.preventDefault();
            $(this).ekkoLightbox();
        });

        var selectedBehaviors = [];

        $('#admin_behavior tbody').on( 'click', '.addButton', function (e) {
            e.preventDefault();
            var id = table.row($(this).closest('tr')).data().id;
            addBehavior(id);
            addTimelineElement(id);
        } );

        $(".removeLastBehavior").click(function(e) {
            e.preventDefault();
            if(selectedBehaviors.length > 0){
                $(".timeLineElement").last().remove();
                selectedBehaviors.pop();
                $("#behaviorBundle").val(selectedBehaviors.toString());
            }
        });

        $(".resetBundle").click(function(e) {
            e.preventDefault();
            $(".bundleTimeline").html("<div class='col-md-2 timeLineElement'>Start</div>");
            selectedBehaviors = [];
            $("#behaviorBundle").val("");
        });

        function addBehavior(id){
            selectedBehaviors.push(id);
            $("#behaviorBundle").val(selectedBehaviors.toString());
        }

        function addTimelineElement(id){
            $(".bundleTimeline").append("<div class='col-md-2 timeLineElement'>" + id + "</div>");
        }

    </script>

}