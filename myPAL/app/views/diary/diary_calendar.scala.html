@(userType: UserType, date: String, realDate: String, activities: List[views.interfaces.DiaryActivityToHTML])

@import play.api.i18n._
@import play.api.libs.json.Json

@diary(Messages("page.diary.base.calendar"), "calendar", userType) {

        <link rel="stylesheet" media="screen" href='@routes.Assets.at("stylesheets/datepicker.css")'>
        <script src=@routes.Assets.at("javascripts/bootstrap-datepicker.js")></script>

    <script type="text/javascript" src="https://www.google.com/jsapi"></script>
    @if(activities.size > 0){
        <script type="text/javascript">
                  google.load("visualization", "1", {packages:["timeline"]});
                  google.setOnLoadCallback(drawChart);

                  function drawChart() {
                    var container = document.getElementById('timeline');
                    var chart = new google.visualization.Timeline(container);
                    var dataTable = new google.visualization.DataTable();

                    dataTable.addColumn({ type: 'string', id: 'DiaryItem' });
                    dataTable.addColumn({ type: 'string', id: 'Type' });
                    dataTable.addColumn({ type: 'date', id: 'Start' });
                    dataTable.addColumn({ type: 'date', id: 'End' });


                    dataTable.addRows([
                    @for(activity <- activities) {
                      [ '@Messages("page.diary.calendar.activity")', '@activity.getType', new Date(0,0,0,@activity.getStartHour,@activity.getStartMin,0), new Date(0,0,0,@activity.getEndHour,@activity.getEndMin,0) ],
                    }
                    ]);


                    var options = {
                        'tooltip' : {trigger: 'none'},
                        colors: [@for(activity <- activities) {'@views.interfaces.DiaryActivityToHTML.diaryActivityTypeToColor(activity.getType)', }]
                    };

                    function getSelectedActivity(index){
                        /*

                            alert(jsonActivities.data[index].email);
                            return ;

                        */
                    }

                    function selectHandler() {
                        $.getJSON('@routes.Diary.getActivities()', function(jsonActivities) {
                            var selectedItem = chart.getSelection()[0];
                            if (selectedItem) {
                                var selectedActivity = jsonActivities[selectedItem.row];
                                $( "div.calendar_selected_title" ).replaceWith("<div class='calendar_selected_title text-center col-md-offset-3 col-md-3'><h3>" + selectedActivity.type + "</h3> (" + selectedActivity.date + ")</div>");
                                $( "div.calendar_selected_description" ).replaceWith("<div class='calendar_selected_description text-center col-md-3'>" + selectedActivity.description + "</div>");
                                $( "div.calendar_selected_emotion" ).replaceWith("<div class='calendar_selected_emotion text-center col-md-3'> <img class='emotionimage' width=65% height=65% src='" + selectedActivity.emotionPicture + "'></div>");
                                $( "div.calendar_selected_picture" ).replaceWith("<div class='calendar_selected_picture text-center col-md-3'>" + "Picture" + "</div>");
                            }
                        });
                    }

                      // Listen for the 'select' event, and call my function selectHandler() when
                      // the user selects something on the chart.
                      google.visualization.events.addListener(chart, 'select', selectHandler);

                      chart.draw(dataTable, options);
                  }
        </script>
    }


        <div class="row">
            <div class="text-left col-md-4 addactivity">
                <a href='@routes.Diary.addActivityPage()' class="btn btn-default addactivitybutton"> <span class="glyphicon glyphicon-plus-sign" aria-hidden="true"></span> @Messages("page.diary.calendar.addactivity")</a>
                <br />
                <a href='' class="btn btn-default addactivitybutton"> <span class="glyphicon glyphicon-plus-sign" aria-hidden="true"></span> @Messages("page.diary.calendar.addmeasurement")</a>
            </div>
            <div id="calendar_head" class="text-center col-md-4">
                <h1>@Messages("page.diary.base.calendar")</h1>
                <a href='@routes.Diary.calendarUpdate("-")' class="btn btn-default"> <span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span></a> <button class="btn btn-default" id="datePicker" data-date="@realDate" data-date-format="dd/mm/yyyy">@date <span class="glyphicon glyphicon-calendar" aria-hidden="true"></span></button> <a href='@routes.Diary.calendarUpdate("+")' class="btn btn-default"> <span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a>
            </div>
        </div>

        <div class="row">
            <div id="timeline" style="width:85%; height:100%;" class="text-center"></div>
        </div>

        <div class="row">
            <div class="calendar_selected_title text-center col-md-offset-3 col-md-3"></div>
        </div>
        <div class="row">
            <div class="calendar_selected_description text-center col-md-3"></div>
            <div class="calendar_selected_emotion text-center col-md-3"></div>
            <div class="calendar_selected_picture text-center col-md-3"></div>
        </div>

    @if(activities.size == 0){
        <div class="text-center">
            <br />
            <h3>No activities available</h3>
        </div>
    }

    <script src=@routes.Assets.at("javascripts/main.js")></script>
}